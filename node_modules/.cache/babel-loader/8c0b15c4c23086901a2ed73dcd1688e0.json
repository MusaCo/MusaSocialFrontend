{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/musli/Desktop/mern MusaSocial/React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/musli/Desktop/mern MusaSocial/React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/musli/Desktop/mern MusaSocial/React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./post.css\";import{MoreVert}from\"@material-ui/icons\";import axios from\"axios\";import{format}from\"timeago.js\";import{useEffect,useState,useContext}from\"react\";import{Link}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post;var _useContext=useContext(AuthContext),currentuser=_useContext.user;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(post.likes.length),_useState4=_slicedToArray(_useState3,2),like=_useState4[0],setLike=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLiked=_useState6[0],setIsLiked=_useState6[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;useEffect(function(){setIsLiked(post.likes.includes(currentuser._id));},[currentuser===null||currentuser===void 0?void 0:currentuser._id,post.likes]);useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"https://musasocialapi.herokuapp.com/users?userId=\".concat(post.userId));case 2:result=_context.sent;setUser(result.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();fetchUser();},[]);var likeHandler=function likeHandler(){try{axios.put(\"https://musasocialapi.herokuapp.com/post/\"+post._id+\"/like\",{userId:currentuser._id});console.log(\"post liked........\");}catch(error){console.log(error);}setLike(isLiked?like-1:like+1);setIsLiked(!isLiked);};return/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"postWrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTopLeft\",children:[/*#__PURE__*/_jsx(Link,{to:\"profile/\".concat(user===null||user===void 0?void 0:user.username),children:/*#__PURE__*/_jsx(\"img\",{src:user.profilePicture?PF+(user===null||user===void 0?void 0:user.profilePicture):PF+\"nopfp.png\",alt:\"\",className:\"postProfileImg\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"postUsername\",children:user===null||user===void 0?void 0:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"postDate\",children:format(post.createdAt)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postTopRight\",children:/*#__PURE__*/_jsx(MoreVert,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postCenter\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"postText\",children:post===null||post===void 0?void 0:post.desc}),/*#__PURE__*/_jsx(\"img\",{src:PF+post.img,alt:\"\",className:\"postImg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postBottomLeft\",children:[/*#__PURE__*/_jsx(\"img\",{src:PF+\"like.png\",alt:\"\",className:\"likeIcon\",onClick:likeHandler}),/*#__PURE__*/_jsx(\"img\",{src:PF+\"heart1.png\",alt:\"\",className:\"likeIcon\",onClick:likeHandler}),/*#__PURE__*/_jsx(\"span\",{className:\"postLikeCounter\",children:like})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postBottomRight\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"postCommentText\",children:[post.comment,\" Comments\"]})})]})]})});}","map":{"version":3,"sources":["C:/Users/musli/Desktop/mern MusaSocial/React/src/components/post/Post.jsx"],"names":["MoreVert","axios","format","useEffect","useState","useContext","Link","AuthContext","Post","post","currentuser","user","setUser","likes","length","like","setLike","isLiked","setIsLiked","PF","process","env","REACT_APP_PUBLIC_FOLDER","includes","_id","fetchUser","get","userId","result","data","likeHandler","put","console","log","error","username","profilePicture","createdAt","desc","img","comment"],"mappings":"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","sourcesContent":["import \"./post.css\"\r\nimport { MoreVert } from \"@material-ui/icons\";\r\nimport  axios  from \"axios\";\r\nimport { format } from \"timeago.js\";\r\nimport { useEffect, useState, useContext } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\n\r\nexport default function Post({post}) {\r\n    const {user:currentuser} = useContext(AuthContext)\r\n    const [user, setUser] = useState({})\r\n    const [like, setLike] = useState(post.likes.length)\r\n    const [isLiked, setIsLiked] = useState(false)\r\n    const PF = process.env.REACT_APP_PUBLIC_FOLDER;\r\n    \r\n    useEffect(() =>{\r\n        setIsLiked(post.likes.includes(currentuser._id));\r\n    }, [currentuser?._id, post.likes]);\r\n\r\n    useEffect(() => {\r\n        const fetchUser = async () =>{\r\n            const result = await axios.get(`https://musasocialapi.herokuapp.com/users?userId=${post.userId}`);\r\n            setUser(result.data)\r\n            \r\n        };\r\n        fetchUser();\r\n    }, []);\r\n\r\n    const likeHandler = () =>{\r\n        try {\r\n            axios.put(\"https://musasocialapi.herokuapp.com/post/\" + post._id + \"/like\", {userId: currentuser._id})\r\n            console.log(\"post liked........\")\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n        setLike(isLiked ? like - 1 : like + 1)\r\n        setIsLiked(!isLiked)\r\n    }\r\n\r\n    return (\r\n        <div className=\"post\">\r\n            <div className=\"postWrapper\">\r\n                <div className=\"postTop\"> \r\n                    <div className=\"postTopLeft\">\r\n                    <Link to={`profile/${user?.username}`}>\r\n                        <img src={ user.profilePicture? PF + user?.profilePicture : PF+\"nopfp.png\"} alt=\"\" className=\"postProfileImg\" />\r\n                    </Link>\r\n                        <span className=\"postUsername\">{user?.username}</span>\r\n                        <span className=\"postDate\">{format(post.createdAt)}</span>\r\n                    </div>\r\n                    <div className=\"postTopRight\">\r\n                        <MoreVert/>\r\n                    </div>\r\n                </div>\r\n                <div className=\"postCenter\">\r\n                    <span className=\"postText\">{post?.desc}</span>\r\n                    <img src={PF+post.img} alt=\"\" className=\"postImg\" />\r\n                </div>\r\n                <div className=\"postBottom\">\r\n                    <div className=\"postBottomLeft\">\r\n                        <img src=  {PF + \"like.png\"}  alt=\"\" className=\"likeIcon\" onClick={likeHandler}/>\r\n                        <img src={PF + \"heart1.png\"} alt=\"\" className=\"likeIcon\" onClick={likeHandler}/>\r\n                        <span className=\"postLikeCounter\">{like}</span>\r\n                    </div>\r\n                    <div className=\"postBottomRight\">\r\n                        <span className=\"postCommentText\">{post.comment} Comments</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}